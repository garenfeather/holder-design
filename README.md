# Holder Design · 功能说明

面向设计生产的 PSD 模板管理与生成工具。支持模板入库、参考图预览、多种 stroke inside 版本、按所选“裁切模板”生成结果，以及完善的结果管理与清理能力。

## 产品概述

- 通过“模板管理”上传 PSD 模板，系统自动校验并生成预览/参考图与 inside（restored.psd）。
- 可在上传时按需开启多种描边（stroke）宽度，生成对应的 inside 版本与透明参考图。
- 在“使用/生成”流程中，先选择“裁切模板”（原始或某个已有的 stroke），再上传图片、选择可选项并生成结果。
- 在“生成素材管理”中查看、下载与清理生成记录。

## 主要功能

- 模板入库
  - 自动校验必需图层：view、part1~4
  - 自动生成：模板预览图、编辑参考图、inside（restored.psd）
  - 可配置多个 stroke 宽度（如 2/5/8），生成对应 inside 与透明参考图

- 裁切模板选择
  - 生成前从下拉中选择：原始（不选）或某个已存在的 stroke 宽度
  - 预览时可叠加“原始/Stroke Npx”的透明参考图用于视觉对比（不影响最终文件）
  - 点击“生成”时才实际使用所选 inside 进行裁切流程

- 生成与部件
  - 根据所选 inside PSD 进行尺寸对齐、按图层形状裁切替换、最终变换
  - 可选部件（window）叠加，整体流程与原方案保持一致
  - 输出最终 PSD 与预览图

- 结果管理
  - 列表、详情、下载、删除、批量清理
  - 详情页预览样式与“生成结果预览”一致（灰底容器 + 图片自适应）
  - 结果命名与标注：选择了 stroke 时，resultId 与下载文件名会追加 `_stroke_{w}px`；详情显示“使用模板：原始 / Stroke Npx”

- 清理与一致性
  - 生成过程的中间产物会自动清理
  - 可按数量/天数批量清理旧结果；提供 `clean_storage.sh` 开发期一键清空

## 使用流程（面向使用者）

1. 上传模板
   - 选择 PSD 文件，系统校验并入库
   - 如需多种描边版本，在上传时配置 stroke 宽度（如 2/5/8），系统会生成对应 inside 与参考图

2. 选择裁切模板
   - 在“裁切模板选择”处选择：原始 / 指定的 stroke 宽度（仅显示已存在项）
   - 可叠加对应参考图进行视觉对比（仅预览，不影响最终文件）

3. 生成
   - 上传图片，可选“强制对齐”与“部件”
   - 点击“生成”，系统按所选裁切模板完成全流程，输出 PSD 与预览

4. 管理结果
   - 在“生成素材管理”中查看列表与详情，下载、删除或批量清理
   - 结果命名带上 stroke 后缀（若有），详情显示使用的模板宽度

## 注意事项

- 仅能选择已存在的 stroke 版本（不会在生成阶段临时新建）
- 如果某个 stroke PSD 被手工清理或不存在，选择该项会提示错误
- 预览叠加仅用于视觉参考；实际裁切仅在点击“生成”时应用所选模板

## 快速启动（简要）

- 后端：进入 backend 目录运行应用（默认端口 8012）
- 前端：进入 frontend 目录安装依赖并运行（默认端口 8001）
- 开发清理：执行根目录的 `clean_storage.sh` 可快速清空存储数据

—— 让 PSD 模板管理与生成更高效、可控。

